<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Behavior-Action Vision</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #eee;
    text-align: center;
    padding: 30px;
}
button {
    padding: 10px 20px;
    margin: 10px;
    font-size: 16px;
    cursor: pointer;
}
input {
    margin: 10px;
}
img {
    max-width: 400px;
    margin-top: 20px;
    border: 2px solid #444;
}
pre {
    background: #222;
    padding: 15px;
    max-width: 700px;
    margin: 20px auto;
    overflow-x: auto;
    text-align: left;
}
.status-stable { color: #00ff88; }
.status-changed { color: #ff4444; }
.status-unknown { color: #ffaa00; }
</style>
</head>

<body>

<h1>üß† Behavior-Action Vision</h1>

<input type="file" id="imageInput" accept="image/*"><br>

<button onclick="setReference()">üìå Setear referencia</button>
<button onclick="analyze()">üîç Analizar comportamiento</button>

<div>
    <img id="preview">
</div>

<h3>Resultado</h3>
<pre id="output">Sin datos</pre>

<script>
async function sendImage(endpoint) {
    const fileInput = document.querySelector('input[type="file"]');
    const resultado = document.getElementById("resultado");

    if (!fileInput || !fileInput.files.length) {
        if (resultado) resultado.innerText = "No hay imagen seleccionada";
        return;
    }

    if (resultado) resultado.innerText = "Procesando...";

    const formData = new FormData();
    formData.append("image", fileInput.files[0]);

    try {
        const res = await fetch(endpoint, {
            method: "POST",
            body: formData
        });

        const data = await res.json();

        if (resultado) {
            resultado.innerText = JSON.stringify(data, null, 2);
        }
    } catch (err) {
        if (resultado) {
            resultado.innerText = "Error: " + err.message;
        }
    }
}

function setReference() {
    sendImage("/reference");
}

function analyze() {
    sendImage("/behavior");
}
</script>



</body>
</html>
