<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Behavior-Action Vision</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #eee;
    text-align: center;
    padding: 30px;
}
button {
    padding: 10px 20px;
    margin: 10px;
    font-size: 16px;
    cursor: pointer;
}
input {
    margin: 10px;
}
img {
    max-width: 400px;
    margin-top: 20px;
    border: 2px solid #444;
}
pre {
    background: #222;
    padding: 15px;
    max-width: 700px;
    margin: 20px auto;
    overflow-x: auto;
    text-align: left;
}
.status-stable { color: #00ff88; }
.status-changed { color: #ff4444; }
.status-unknown { color: #ffaa00; }
</style>
</head>

<body>

<h1>üß† Behavior-Action Vision</h1>

<input type="file" id="imageInput" accept="image/*"><br>

<button onclick="setReference()">üìå Setear referencia</button>
<button onclick="analyze()">üîç Analizar comportamiento</button>

<div>
    <img id="preview">
</div>

<h3>Resultado</h3>
<pre id="output">Sin datos</pre>

<script>
const imageInput = document.getElementById("imageInput");
const preview = document.getElementById("preview");
const output = document.getElementById("output");

imageInput.onchange = () => {
    const file = imageInput.files[0];
    if (file) preview.src = URL.createObjectURL(file);
};

function send(endpoint) {
    const file = imageInput.files[0];
    if (!file) {
        alert("Seleccion√° una imagen");
        return;
    }

    const formData = new FormData();
    formData.append("image", file);

    fetch(endpoint, {
        method: "POST",
        body: formData
    })
    .then(r => r.json())
    .then(data => {
        let behavior = data.behavior || "unknown";
        let cls = "status-" + behavior;

        output.innerHTML =
            `<span class="${cls}">${JSON.stringify(data, null, 2)}</span>`;
    })
    .catch(err => {
        output.textContent = "Error: " + err;
    });
}

function setReference() {
    send("/set_reference");
}

function analyze() {
    send("/analyze");
}
</script>

</body>
</html>
